# PROGRAMMED TO SURVIVE 統合仕様書（ToBe / 最終確定）

## 0. コンセプト
- プログラムは設計通りにのみ動作する。
- プレイヤーは直接操作しない。
- ゲームは完全フルオートで進行する。
- 成功・失敗はすべて事前設計の結果で決定する。
- 本作は「設計評価」を楽しむゲームである。

## 1. 基本情報
- タイトル: PROGRAMMED TO SURVIVE
- ジャンル: 自動戦闘サバイバル・ロボット
- プラットフォーム: itch.io（HTML5）
- 使用FW: Phaser 3
- 画面: スマホ縦画面（PC対応）
- 操作: 事前設定のみ（戦闘中操作なし）
- 1プレイ: 約5〜10分
- リトライ: 即時

## 2. ゲームフロー
1. 機体選択
2. 武器2種選択（MAIN / SUB）
3. AI性格・方針設定
4. Battle Start（完全自動）
5. 敵撃破・障害物破壊
6. Wave進行（30秒ごと）
7. HP0で戦闘終了
8. 死因レポート表示
9. リトライ

## 3. カメラ・マップ
### カメラ
- 常に自機を中心に追従する。
- 最大射程に合わせてズームする。
- プレイヤー操作は不可。

### マップ
- 実質無限。
- 壁で詰んで即死しない。
- 障害物は完全ランダム生成。
- 障害物の密集密度に上限を設ける。

## 4. Wave・敵出現
### Wave
- 30秒固定でWave+1。

### 敵数（線形増加）
- 量産: 8 + 2*Wave
- エリート: floor((Wave-2)/2)（0未満は0）
- ボス: 5Waveごとに1体

### 敵種別ステータス（初期）
| 種別 | HP | 速度(px/s) | 接触DPS | XP |
| --- | --- | --- | --- | --- |
| 量産 | 25 | 85 | 8 | 1 |
| エリート | 110 | 95 | 14 | 6 |
| ボス | 900 | 70 | 22 | 50 |

- HPはWaveに応じて線形上昇する。

## 5. 機体（Chassis）
| 機体 | HP | 速度 | EN最大 | EN回復/s | 索敵半径 |
| --- | --- | --- | --- | --- | --- |
| Light | 120 | 220 | 100 | 18 | 520 |
| Middle | 160 | 190 | 120 | 15 | 480 |
| Heavy | 220 | 160 | 150 | 12 | 440 |

## 6. エネルギーシステム
- 消費対象: ジャンプ／ダッシュのみ。
- ジャンプ: EN -25。
- ダッシュ: EN -45。
- 同時使用可能。
- ENは時間経過で回復する。
- EN枯渇中は移動スキル使用不可。

## 7. 索敵・視界
- 敵は索敵半径外からスポーンする。
- 半径内: フル情報（位置・種別）。
- 半径外: 不可視。
- 障害物越し: ぼんやり可視。
- レーダー点表示。
- 種別不明。
- 位置誤差: ±18px。
- 更新間隔: 250ms。
- 発見順は「フル可視になった瞬間」とする。

## 8. ロック・ターゲット
- ロック切替CD: 1秒。
- 遮蔽が0.3秒継続するとロック解除。
- ロック対象は◇＋赤ライン表示。
- ターゲット選択方針（AI設定）:
  - 距離優先。
  - 発見順優先。

## 9. 障害物
### 基本
- 完全ランダム生成。
- すべて破壊可能。
- HPを持つ。
- 射線・爆風を遮蔽する。

### 材質（3種）
| 材質 | 見た目 | HP倍率 |
| --- | --- | --- |
| Light | 明るい | ×0.8 |
| Standard | 標準 | ×1.0 |
| Heavy | 濃い | ×1.6 |

### HP計算
- baseHP = (width * height) / 12
- hp = clamp(baseHP * materialMul, 40, 520)

## 10. 武器（共通仕様）
### 全武器共通パラメータ
- 攻撃力
- 攻撃間隔
- 射程距離
- 弾速（該当武器）
- 射程範囲
- 爆発範囲（該当武器）

### 共通ルール
- 弾は最大射程で消滅する。
- 爆風は障害物で遮蔽される。

## 11. 武器一覧（初期値）
### ブレード
- 攻撃力: 14
- 攻撃間隔: 520ms
- 射程: 140px
- 扇角: 78°
- 持続: 160ms

#### 固有強化
- 扇角 +6°（cap 140°）
- 持続 +20ms（cap 360ms）

### マシンガン
- 攻撃力: 6
- 攻撃間隔: 180ms
- 弾速: 760px/s
- 射程: 520px

### キャノン
- 攻撃力: 30
- 攻撃間隔: 920ms
- 弾速: 540px/s
- 射程: 700px
- 爆風: 80px

### ミサイル
- 攻撃力: 20
- 攻撃間隔: 700ms
- 弾速: 520px/s
- 射程: 680px
- 爆風: 70px
- 追尾性能: 0.35

### グレネード
- 攻撃力: 18
- 攻撃間隔: 600ms
- 弾速: 460px/s
- 射程: 360px
- 爆風: 95px

### 地雷
- 攻撃力: 40
- 再設置: 2200ms
- 設置数: 1
- 爆風: 90px

## 12. Lvアップ（フルオート）
- 事前に優先リストを作成する。
- Lvアップ時に先頭項目を1段階強化する。
- 末尾まで行ったらループする。
- 強化幅は固定値とする。
- 各項目にcapを設ける。

### 共通強化
- 攻撃力 +2（cap +60）
- 攻撃間隔 -60ms（最短220ms）
- 射程 +28px（cap +280px）
- 弾速 +70px/s（cap +700px/s）

## 13. 経験値・アイテム
- 敵撃破: 経験値ドロップ。
- 障害物破壊: レアアイテムドロップ（0.1%）。
- 自動回収距離:
  - XP: 140px
  - アイテム: 120px
- 障害物越し回収: 可能。
- 取得優先はAI設定。

## 14. レアアイテム
- 効果: 攻撃倍率 +0.1%。
- 上限: +5%。
- 対象: メイン武器 → cap後はサブ。
- プレイ中のみ有効。

## 15. AI設定
### 判断軸
- 距離
- 危険度（実測優先）
- エネルギー
- 障害物
- アイテム
- 逃走

### 重み付け（初期）
- 敵: 0.65
- アイテム: 0.25
- 逃げ: 0.10
- 障害物: 0.20

## 16. ログ（画面表示）
- 最新10〜14行を表示する。

### 種別
- LOCK / UNLOCK
- ATTACK
- DAMAGE
- KILL
- OBJECT_DESTROY
- ITEM_PICKUP
- JUMP / DASH
- AI_STATE / AI_REASON

## 17. 死因レポート
- 生存時間
- 到達Wave
- 撃破数
- 累計被ダメージ
- 被弾回数
- EN枯渇回数／時間
- 遮蔽で攻撃不能だった時間
- 障害物破壊数
- レア取得数

- 主因・副因は定量評価で算出する。
