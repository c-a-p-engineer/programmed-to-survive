<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>PROGRAMMED TO SURVIVE - Prototype</title>
  <style>
    html,body{margin:0;padding:0;background:#05070b;color:#e8eefc;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow:hidden}
    #wrap{position:fixed;inset:0;display:flex;align-items:stretch;justify-content:center}
    #game{flex:1;max-width:520px;position:relative}
    canvas{display:block;width:100%;height:100%}
    .panel{
      position:absolute;left:0;right:0;top:0;bottom:0;
      display:flex;flex-direction:column;gap:12px;
      padding:16px;
      background:linear-gradient(180deg,rgba(5,7,11,.92),rgba(5,7,11,.78));
      backdrop-filter: blur(6px);
    }
    .hidden{display:none}
    h1{margin:0;font-size:20px;letter-spacing:.04em}
    .sub{opacity:.8;font-size:12px;line-height:1.4}
    .grid{display:grid;grid-template-columns:1fr;gap:10px}
    .row{display:flex;gap:10px}
    label{font-size:12px;opacity:.9}
    select,button{
      width:100%;
      padding:12px 12px;
      background:#0b1220;border:1px solid rgba(232,238,252,.14);
      color:#e8eefc;border-radius:12px;
      font-size:14px;
      outline:none;
    }
    button{background:#0d1b2e;border-color:rgba(0,255,204,.35)}
    button:active{transform:translateY(1px)}
    .tiny{font-size:11px;opacity:.7}
    .kpi{display:flex;gap:10px;flex-wrap:wrap}
    .pill{padding:6px 10px;border-radius:999px;background:rgba(232,238,252,.08);border:1px solid rgba(232,238,252,.10);font-size:12px}
    .good{border-color:rgba(0,255,204,.35);background:rgba(0,255,204,.08)}
    .bad{border-color:rgba(255,79,216,.28);background:rgba(255,79,216,.08)}
    #toast{
      position:absolute;left:12px;right:12px;bottom:12px;
      padding:10px 12px;border-radius:12px;
      background:rgba(0,0,0,.55);border:1px solid rgba(232,238,252,.14);
      font-size:12px;opacity:.92;pointer-events:none
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>

<style>
  #debugBtn{position:absolute;right:12px;top:12px;z-index:20;padding:8px 10px;border-radius:10px;
    background:#1a2235;color:#e8eefc;border:1px solid rgba(232,238,252,.25);font-size:12px}
  #debugPanel{position:absolute;left:12px;right:12px;bottom:12px;max-height:40%;overflow:auto;z-index:20;
    background:rgba(0,0,0,.65);border:1px solid rgba(232,238,252,.2);border-radius:12px;
    padding:8px;font-size:11px;display:none;white-space:pre-wrap}
</style>
<style>
  #mechLogPanel{
    position:absolute;
    right:12px;
    top:140px;
    width:min(46vw, 360px);
    max-height:42vh;
    overflow:hidden;
    z-index:25;
    pointer-events:none;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    font-size:11px;
    line-height:1.25;
    color:#e8eefc;
    background:rgba(0,0,0,.35);
    border:1px solid rgba(232,238,252,.18);
    border-radius:12px;
    padding:8px 10px;
    box-shadow: 0 6px 18px rgba(0,0,0,.35);
    backdrop-filter: blur(6px);
    display:none;
  }
  #mechLogPanel .t{opacity:.8;margin-bottom:6px;letter-spacing:.08em}
  #mechLogPanel .line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  #mechLogPanel .c-sys{color:#b8c6ff}
  #mechLogPanel .c-lock{color:#00ffcc}
  #mechLogPanel .c-kill{color:#7CFF8A}
  #mechLogPanel .c-obj{color:#FFD36B}
  #mechLogPanel .c-dmg{color:#FF6B6B}
</style>
</head>
<body>

<button id="debugBtn">DEBUG</button>
<div id="debugPanel"></div>
<div id="mechLogPanel"><div class="t">MECH LOG</div><div id="mechLogLines"></div></div>
<div id="wrap">
  <div id="game">
    <div id="startPanel" class="panel">
      <h1>PROGRAMMED TO SURVIVE</h1>
      <div class="sub">プロトタイプ：設定 → 自動戦闘 → HP0でリザルト＆リトライ</div>

      <div class="grid">
        <div>
          <label>機体</label>
          <select id="selFrame"></select>
          <div class="tiny" id="frameDesc"></div>
        </div>

        <div class="row">
          <div style="flex:1">
            <label>武器（MAIN）</label>
            <select id="selWpnA"></select>
            <div class="tiny" id="wpnADesc"></div>
          </div>
          <div style="flex:1">
            <label>武器（SUB）</label>
            <select id="selWpnB"></select>
            <div class="tiny" id="wpnBDesc"></div>
          </div>
        </div>

        <div>
          <label>AI（性格）</label>
          <select id="selAI"></select>
          <div class="tiny" id="aiDesc"></div>
        </div>
      </div>

      <div class="kpi" id="kpi"></div>

      <button id="btnStart">BATTLE START</button>
      <div class="tiny">※ スマホでエラーが見えない場合は、この画面下のトーストに出します</div>
      <div id="toast">READY</div>
    </div>

    <div id="resultPanel" class="panel hidden">
      <h1>RESULT</h1>
      <div class="sub" id="resultText">—</div>
      <div class="kpi" id="resultKpi"></div>
      <button id="btnRetry">RETRY</button>
      <div class="tiny">（プロトなので、成長・Wave・ログは次フェーズ）</div>
    </div>
  </div>
</div>

<script type="module" src="./main.ts"></script>

</body>
</html>
